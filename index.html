<!doctype html>
<html>
<head>
    <title>Many Points with  leaflet WebGL</title>
    <meta charset="utf-8">

    <style>
        html, body {
            height: 100%;
            padding: 0;
            margin: 0;
            background: rgb(14, 21, 30);
        }

        #map {
            position: absolute;
            height: 100%;
            width: 100%;
            background-color: #333;
        }
    </style>
</head>
<body>
<div id="map"></div>
<link rel="stylesheet" href="bower_components/leaflet/dist/leaflet.css" />
<script src="bower_components/leaflet/dist/leaflet.js"></script>
<script src="leaflet.glify.js"></script>
<script src="leaflet.canvasoverlay.js"></script>
<script>
    function wget(urls, fn) {
        var results = [],
            lookup = {},
            complete = 0,
            total = urls.length;

        urls.forEach(function(url) {
            var i = lookup[url] = results.length,
                request = new XMLHttpRequest();
            results.push(null);
            request.open('GET', url, true);
            request.onload = function () {
                if (request.status < 200 && request.status > 400) return;
                results[i] = request.responseText;
                complete++;
                if (complete === total) fn.apply(null, results);
            };
            request.send();
        });
    }

    var map = L.map('map')
            .setView([50.00, 14.44], 8);

    L.tileLayer("http://{s}.sm.mapstack.stamen.com/(toner-background,$fff[difference],$fff[@23],$fff[hsl-saturation@20],toner-lines[destination-in])/{z}/{x}/{y}.png")
        //L.tileLayer("http://{s}.sm.mapstack.stamen.com/(toner-lite,$fff[difference],$fff[@23],$fff[hsl-saturation@20])/{z}/{x}/{y}.png")
        .addTo(map);

    wget(['fragment-shader.glsl', 'vertex-shader.glsl', '86T.json'],
        function(fragmentShader, vertexShader, raw) {
            L.Glify.prototype.fragmentShaderTemplate = fragmentShader;
            L.Glify.prototype.vertexShaderTemplate = vertexShader;

            L.glify({
                map: map,
                clickPoint: function (point) {

                }
            })
            .setData(JSON.parse(raw))
            .render();
        });
</script>
</body>
</html>